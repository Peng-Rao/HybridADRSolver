\doxysection{Hybrid\+ADRSolver\+::Matrix\+Based\+Solver\texorpdfstring{$<$}{<} dim \texorpdfstring{$>$}{>} Class Template Reference}
\hypertarget{class_hybrid_a_d_r_solver_1_1_matrix_based_solver}{}\label{class_hybrid_a_d_r_solver_1_1_matrix_based_solver}\index{HybridADRSolver::MatrixBasedSolver$<$ dim $>$@{HybridADRSolver::MatrixBasedSolver$<$ dim $>$}}


Matrix-\/based solver with hybrid MPI+threading parallelization.  




{\ttfamily \#include $<$matrix\+\_\+based\+\_\+solver.\+h$>$}

Inheritance diagram for Hybrid\+ADRSolver\+::Matrix\+Based\+Solver\texorpdfstring{$<$}{<} dim \texorpdfstring{$>$}{>}\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{class_hybrid_a_d_r_solver_1_1_matrix_based_solver}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_hybrid_a_d_r_solver_1_1_matrix_based_solver_affb0e630094162959273f04fe9b6d4e3}{Matrix\+Based\+Solver}} (const \mbox{\hyperlink{class_hybrid_a_d_r_solver_1_1_problem_interface}{Problem\+Interface}}$<$ dim $>$ \&problem, unsigned int degree, MPI\+\_\+\+Comm comm, const \mbox{\hyperlink{struct_hybrid_a_d_r_solver_1_1_solver_parameters}{Solver\+Parameters}} \&params=\mbox{\hyperlink{struct_hybrid_a_d_r_solver_1_1_solver_parameters}{Solver\+Parameters}}())
\item 
void \mbox{\hyperlink{class_hybrid_a_d_r_solver_1_1_matrix_based_solver_a4bbae5042093a6b35b49b09cf75f0e41}{run}} (unsigned int n\+\_\+refinements) override
\item 
\mbox{\hyperlink{types_8h_afe6d3d39f0c710383621e32a46108cb1}{Solver\+Type}} \mbox{\hyperlink{class_hybrid_a_d_r_solver_1_1_matrix_based_solver_ae4d8a5c8ac4f6962e896aaacb2ac34a5}{get\+\_\+solver\+\_\+type}} () const override
\item 
std\+::string \mbox{\hyperlink{class_hybrid_a_d_r_solver_1_1_matrix_based_solver_a1ef87541c7adc19b96f054eb3f5f8f8a}{get\+\_\+name}} () const override
\item 
const LADistributed\+::\+MPI\+::\+Sparse\+Matrix \& \mbox{\hyperlink{class_hybrid_a_d_r_solver_1_1_matrix_based_solver_aaaff7f655ceff25801a96e1942eec2ca}{get\+\_\+system\+\_\+matrix}} () const
\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions inherited from \mbox{\hyperlink{class_hybrid_a_d_r_solver_1_1_parallel_solver_base}{Hybrid\+ADRSolver\+::\+Parallel\+Solver\+Base$<$ dim $>$}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_hybrid_a_d_r_solver_1_1_parallel_solver_base_a77ab963e0e19f20b7796391228249776}{Parallel\+Solver\+Base}} (MPI\+\_\+\+Comm comm, const \mbox{\hyperlink{struct_hybrid_a_d_r_solver_1_1_solver_parameters}{Solver\+Parameters}} \&params)
\item 
const \mbox{\hyperlink{struct_hybrid_a_d_r_solver_1_1_timing_results}{Timing\+Results}} \& \mbox{\hyperlink{class_hybrid_a_d_r_solver_1_1_parallel_solver_base_a189b05a7ddae0a51cdf40835ab3530bf}{get\+\_\+timing\+\_\+results}} () const
\end{DoxyCompactItemize}
\doxysubsubsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{class_hybrid_a_d_r_solver_1_1_matrix_based_solver_a43b399d0de2daf8edb8d18c32d65729f}{setup\+\_\+dofs}} () override
\item 
void \mbox{\hyperlink{class_hybrid_a_d_r_solver_1_1_matrix_based_solver_ad9e2e2bf2704651f102d06e87594055b}{assemble\+\_\+system}} () override
\item 
void \mbox{\hyperlink{class_hybrid_a_d_r_solver_1_1_matrix_based_solver_a42698f5fb46f66c40aeccd03c277c05e}{solve}} () override
\item 
void \mbox{\hyperlink{class_hybrid_a_d_r_solver_1_1_matrix_based_solver_a8d28cb187f683255906fe85103f51e07}{output\+\_\+results}} (unsigned int cycle) const override
\item 
\Hypertarget{class_hybrid_a_d_r_solver_1_1_matrix_based_solver_a73a1b346ee13ee32237a25baa5fd91ba}\label{class_hybrid_a_d_r_solver_1_1_matrix_based_solver_a73a1b346ee13ee32237a25baa5fd91ba} 
double {\bfseries compute\+\_\+l2\+\_\+error} ()
\end{DoxyCompactItemize}
\doxysubsection*{Protected Member Functions inherited from \mbox{\hyperlink{class_hybrid_a_d_r_solver_1_1_parallel_solver_base}{Hybrid\+ADRSolver\+::\+Parallel\+Solver\+Base$<$ dim $>$}}}
\begin{DoxyCompactItemize}
\item 
virtual void \mbox{\hyperlink{class_hybrid_a_d_r_solver_1_1_parallel_solver_base_a1a8f8a07786c68b12898e58ad345a4cc}{setup\+\_\+grid}} (const unsigned int n\+\_\+refinements)
\end{DoxyCompactItemize}
\doxysubsubsection*{Additional Inherited Members}
\doxysubsection*{Protected Attributes inherited from \mbox{\hyperlink{class_hybrid_a_d_r_solver_1_1_parallel_solver_base}{Hybrid\+ADRSolver\+::\+Parallel\+Solver\+Base$<$ dim $>$}}}
\begin{DoxyCompactItemize}
\item 
MPI\+\_\+\+Comm {\bfseries mpi\+\_\+communicator}
\item 
unsigned int {\bfseries n\+\_\+mpi\+\_\+processes}
\item 
unsigned int {\bfseries this\+\_\+mpi\+\_\+process}
\item 
parallel\+::distributed\+::\+Triangulation$<$ dim $>$ {\bfseries triangulation}
\item 
std\+::unique\+\_\+ptr$<$ Finite\+Element$<$ dim $>$ $>$ {\bfseries fe}
\item 
Do\+FHandler$<$ dim $>$ {\bfseries dof\+\_\+handler}
\item 
std\+::unique\+\_\+ptr$<$ Mapping$<$ dim $>$ $>$ {\bfseries mapping}
\item 
Affine\+Constraints$<$ double $>$ {\bfseries constraints}
\item 
Index\+Set {\bfseries locally\+\_\+owned\+\_\+dofs}
\item 
Index\+Set {\bfseries locally\+\_\+relevant\+\_\+dofs}
\item 
\mbox{\hyperlink{struct_hybrid_a_d_r_solver_1_1_solver_parameters}{Solver\+Parameters}} {\bfseries parameters}
\item 
\mbox{\hyperlink{struct_hybrid_a_d_r_solver_1_1_timing_results}{Timing\+Results}} {\bfseries timing\+\_\+results}
\item 
Conditional\+OStream {\bfseries pcout}
\item 
Timer\+Output {\bfseries computing\+\_\+timer}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\subsubsection*{template$<$int dim$>$\newline
class Hybrid\+ADRSolver\+::\+Matrix\+Based\+Solver$<$ dim $>$}
Matrix-\/based solver with hybrid MPI+threading parallelization. 


\begin{DoxyItemize}
\item This solver\+:
\item Explicitly assembles and stores the sparse system matrix
\item Uses Work\+Stream for thread-\/parallel assembly
\item Uses PETSc for distributed linear algebra
\item Supports ILU and AMG preconditioning
\item 
\begin{DoxyTemplParams}{Template Parameters}
{\em dim} & Spatial dimension \\
\hline
\end{DoxyTemplParams}

\end{DoxyItemize}

\label{doc-constructors}
\Hypertarget{class_hybrid_a_d_r_solver_1_1_matrix_based_solver_doc-constructors}
\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{class_hybrid_a_d_r_solver_1_1_matrix_based_solver_affb0e630094162959273f04fe9b6d4e3}\index{HybridADRSolver::MatrixBasedSolver$<$ dim $>$@{HybridADRSolver::MatrixBasedSolver$<$ dim $>$}!MatrixBasedSolver@{MatrixBasedSolver}}
\index{MatrixBasedSolver@{MatrixBasedSolver}!HybridADRSolver::MatrixBasedSolver$<$ dim $>$@{HybridADRSolver::MatrixBasedSolver$<$ dim $>$}}
\doxysubsubsection{\texorpdfstring{MatrixBasedSolver()}{MatrixBasedSolver()}}
{\footnotesize\ttfamily \label{class_hybrid_a_d_r_solver_1_1_matrix_based_solver_affb0e630094162959273f04fe9b6d4e3} 
template$<$int dim$>$ \\
\mbox{\hyperlink{class_hybrid_a_d_r_solver_1_1_matrix_based_solver}{Hybrid\+ADRSolver\+::\+Matrix\+Based\+Solver}}$<$ dim $>$\+::\+Matrix\+Based\+Solver (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_hybrid_a_d_r_solver_1_1_problem_interface}{Problem\+Interface}}$<$ dim $>$ \&}]{problem}{, }\item[{unsigned int}]{degree}{, }\item[{MPI\+\_\+\+Comm}]{comm}{, }\item[{const \mbox{\hyperlink{struct_hybrid_a_d_r_solver_1_1_solver_parameters}{Solver\+Parameters}} \&}]{params}{ = {\ttfamily \mbox{\hyperlink{struct_hybrid_a_d_r_solver_1_1_solver_parameters}{Solver\+Parameters}}()}}\end{DoxyParamCaption})}

Constructor 
\begin{DoxyParams}{Parameters}
{\em problem} & The PDE problem to solve \\
\hline
{\em degree} & Polynomial degree of finite elements \\
\hline
{\em comm} & MPI communicator \\
\hline
{\em params} & Solver parameters \\
\hline
\end{DoxyParams}


\label{doc-func-members}
\Hypertarget{class_hybrid_a_d_r_solver_1_1_matrix_based_solver_doc-func-members}
\doxysubsection{Member Function Documentation}
\Hypertarget{class_hybrid_a_d_r_solver_1_1_matrix_based_solver_ad9e2e2bf2704651f102d06e87594055b}\index{HybridADRSolver::MatrixBasedSolver$<$ dim $>$@{HybridADRSolver::MatrixBasedSolver$<$ dim $>$}!assemble\_system@{assemble\_system}}
\index{assemble\_system@{assemble\_system}!HybridADRSolver::MatrixBasedSolver$<$ dim $>$@{HybridADRSolver::MatrixBasedSolver$<$ dim $>$}}
\doxysubsubsection{\texorpdfstring{assemble\_system()}{assemble\_system()}}
{\footnotesize\ttfamily \label{class_hybrid_a_d_r_solver_1_1_matrix_based_solver_ad9e2e2bf2704651f102d06e87594055b} 
template$<$int dim$>$ \\
void \mbox{\hyperlink{class_hybrid_a_d_r_solver_1_1_matrix_based_solver}{Hybrid\+ADRSolver\+::\+Matrix\+Based\+Solver}}$<$ dim $>$\+::assemble\+\_\+system (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}, {\ttfamily [virtual]}}

Assemble the system (matrix and/or RHS) The worker lambda function. This runs on multiple threads to assemble local cell matrices.

Implements \mbox{\hyperlink{class_hybrid_a_d_r_solver_1_1_parallel_solver_base_a1c0394fd4e16b7a0c321f8d6f23fa867}{Hybrid\+ADRSolver\+::\+Parallel\+Solver\+Base$<$ dim $>$}}.

\Hypertarget{class_hybrid_a_d_r_solver_1_1_matrix_based_solver_a1ef87541c7adc19b96f054eb3f5f8f8a}\index{HybridADRSolver::MatrixBasedSolver$<$ dim $>$@{HybridADRSolver::MatrixBasedSolver$<$ dim $>$}!get\_name@{get\_name}}
\index{get\_name@{get\_name}!HybridADRSolver::MatrixBasedSolver$<$ dim $>$@{HybridADRSolver::MatrixBasedSolver$<$ dim $>$}}
\doxysubsubsection{\texorpdfstring{get\_name()}{get\_name()}}
{\footnotesize\ttfamily \label{class_hybrid_a_d_r_solver_1_1_matrix_based_solver_a1ef87541c7adc19b96f054eb3f5f8f8a} 
template$<$int dim$>$ \\
std\+::string \mbox{\hyperlink{class_hybrid_a_d_r_solver_1_1_matrix_based_solver}{Hybrid\+ADRSolver\+::\+Matrix\+Based\+Solver}}$<$ dim $>$\+::get\+\_\+name (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}

Get a descriptive name for the solver 

Implements \mbox{\hyperlink{class_hybrid_a_d_r_solver_1_1_parallel_solver_base_a81a0595ff4a42d68c353d5ba01614be4}{Hybrid\+ADRSolver\+::\+Parallel\+Solver\+Base$<$ dim $>$}}.

\Hypertarget{class_hybrid_a_d_r_solver_1_1_matrix_based_solver_ae4d8a5c8ac4f6962e896aaacb2ac34a5}\index{HybridADRSolver::MatrixBasedSolver$<$ dim $>$@{HybridADRSolver::MatrixBasedSolver$<$ dim $>$}!get\_solver\_type@{get\_solver\_type}}
\index{get\_solver\_type@{get\_solver\_type}!HybridADRSolver::MatrixBasedSolver$<$ dim $>$@{HybridADRSolver::MatrixBasedSolver$<$ dim $>$}}
\doxysubsubsection{\texorpdfstring{get\_solver\_type()}{get\_solver\_type()}}
{\footnotesize\ttfamily \label{class_hybrid_a_d_r_solver_1_1_matrix_based_solver_ae4d8a5c8ac4f6962e896aaacb2ac34a5} 
template$<$int dim$>$ \\
\mbox{\hyperlink{types_8h_afe6d3d39f0c710383621e32a46108cb1}{Solver\+Type}} \mbox{\hyperlink{class_hybrid_a_d_r_solver_1_1_matrix_based_solver}{Hybrid\+ADRSolver\+::\+Matrix\+Based\+Solver}}$<$ dim $>$\+::get\+\_\+solver\+\_\+type (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}

Get the solver type (matrix-\/based or matrix-\/free) 

Implements \mbox{\hyperlink{class_hybrid_a_d_r_solver_1_1_parallel_solver_base_a17a1f03f110b6c0a6a2837c514c24d24}{Hybrid\+ADRSolver\+::\+Parallel\+Solver\+Base$<$ dim $>$}}.

\Hypertarget{class_hybrid_a_d_r_solver_1_1_matrix_based_solver_aaaff7f655ceff25801a96e1942eec2ca}\index{HybridADRSolver::MatrixBasedSolver$<$ dim $>$@{HybridADRSolver::MatrixBasedSolver$<$ dim $>$}!get\_system\_matrix@{get\_system\_matrix}}
\index{get\_system\_matrix@{get\_system\_matrix}!HybridADRSolver::MatrixBasedSolver$<$ dim $>$@{HybridADRSolver::MatrixBasedSolver$<$ dim $>$}}
\doxysubsubsection{\texorpdfstring{get\_system\_matrix()}{get\_system\_matrix()}}
{\footnotesize\ttfamily \label{class_hybrid_a_d_r_solver_1_1_matrix_based_solver_aaaff7f655ceff25801a96e1942eec2ca} 
template$<$int dim$>$ \\
const LADistributed\+::\+MPI\+::\+Sparse\+Matrix \& \mbox{\hyperlink{class_hybrid_a_d_r_solver_1_1_matrix_based_solver}{Hybrid\+ADRSolver\+::\+Matrix\+Based\+Solver}}$<$ dim $>$\+::get\+\_\+system\+\_\+matrix (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}

Get the system matrix (for analysis/debugging) \Hypertarget{class_hybrid_a_d_r_solver_1_1_matrix_based_solver_a8d28cb187f683255906fe85103f51e07}\index{HybridADRSolver::MatrixBasedSolver$<$ dim $>$@{HybridADRSolver::MatrixBasedSolver$<$ dim $>$}!output\_results@{output\_results}}
\index{output\_results@{output\_results}!HybridADRSolver::MatrixBasedSolver$<$ dim $>$@{HybridADRSolver::MatrixBasedSolver$<$ dim $>$}}
\doxysubsubsection{\texorpdfstring{output\_results()}{output\_results()}}
{\footnotesize\ttfamily \label{class_hybrid_a_d_r_solver_1_1_matrix_based_solver_a8d28cb187f683255906fe85103f51e07} 
template$<$int dim$>$ \\
void \mbox{\hyperlink{class_hybrid_a_d_r_solver_1_1_matrix_based_solver}{Hybrid\+ADRSolver\+::\+Matrix\+Based\+Solver}}$<$ dim $>$\+::output\+\_\+results (\begin{DoxyParamCaption}\item[{unsigned int}]{cycle}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}, {\ttfamily [virtual]}}

Output results to files 
\begin{DoxyParams}{Parameters}
{\em cycle} & Current refinement cycle \\
\hline
\end{DoxyParams}


Implements \mbox{\hyperlink{class_hybrid_a_d_r_solver_1_1_parallel_solver_base_a1cabfab934aea3b3c0db0573e0291a63}{Hybrid\+ADRSolver\+::\+Parallel\+Solver\+Base$<$ dim $>$}}.

\Hypertarget{class_hybrid_a_d_r_solver_1_1_matrix_based_solver_a4bbae5042093a6b35b49b09cf75f0e41}\index{HybridADRSolver::MatrixBasedSolver$<$ dim $>$@{HybridADRSolver::MatrixBasedSolver$<$ dim $>$}!run@{run}}
\index{run@{run}!HybridADRSolver::MatrixBasedSolver$<$ dim $>$@{HybridADRSolver::MatrixBasedSolver$<$ dim $>$}}
\doxysubsubsection{\texorpdfstring{run()}{run()}}
{\footnotesize\ttfamily \label{class_hybrid_a_d_r_solver_1_1_matrix_based_solver_a4bbae5042093a6b35b49b09cf75f0e41} 
template$<$int dim$>$ \\
void \mbox{\hyperlink{class_hybrid_a_d_r_solver_1_1_matrix_based_solver}{Hybrid\+ADRSolver\+::\+Matrix\+Based\+Solver}}$<$ dim $>$\+::run (\begin{DoxyParamCaption}\item[{unsigned int}]{n\+\_\+refinements}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}

Run the complete solve cycle 
\begin{DoxyParams}{Parameters}
{\em n\+\_\+refinements} & Number of global mesh refinements \\
\hline
\end{DoxyParams}


Implements \mbox{\hyperlink{class_hybrid_a_d_r_solver_1_1_parallel_solver_base_a292eb2256eb64421c621ceb4fce5a70e}{Hybrid\+ADRSolver\+::\+Parallel\+Solver\+Base$<$ dim $>$}}.

\Hypertarget{class_hybrid_a_d_r_solver_1_1_matrix_based_solver_a43b399d0de2daf8edb8d18c32d65729f}\index{HybridADRSolver::MatrixBasedSolver$<$ dim $>$@{HybridADRSolver::MatrixBasedSolver$<$ dim $>$}!setup\_dofs@{setup\_dofs}}
\index{setup\_dofs@{setup\_dofs}!HybridADRSolver::MatrixBasedSolver$<$ dim $>$@{HybridADRSolver::MatrixBasedSolver$<$ dim $>$}}
\doxysubsubsection{\texorpdfstring{setup\_dofs()}{setup\_dofs()}}
{\footnotesize\ttfamily \label{class_hybrid_a_d_r_solver_1_1_matrix_based_solver_a43b399d0de2daf8edb8d18c32d65729f} 
template$<$int dim$>$ \\
void \mbox{\hyperlink{class_hybrid_a_d_r_solver_1_1_matrix_based_solver}{Hybrid\+ADRSolver\+::\+Matrix\+Based\+Solver}}$<$ dim $>$\+::setup\+\_\+dofs (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}, {\ttfamily [virtual]}}

Distribute degrees of freedom and setup constraints 

Implements \mbox{\hyperlink{class_hybrid_a_d_r_solver_1_1_parallel_solver_base_ad78ad9c73638fe3e8e0ca020453b41e5}{Hybrid\+ADRSolver\+::\+Parallel\+Solver\+Base$<$ dim $>$}}.

\Hypertarget{class_hybrid_a_d_r_solver_1_1_matrix_based_solver_a42698f5fb46f66c40aeccd03c277c05e}\index{HybridADRSolver::MatrixBasedSolver$<$ dim $>$@{HybridADRSolver::MatrixBasedSolver$<$ dim $>$}!solve@{solve}}
\index{solve@{solve}!HybridADRSolver::MatrixBasedSolver$<$ dim $>$@{HybridADRSolver::MatrixBasedSolver$<$ dim $>$}}
\doxysubsubsection{\texorpdfstring{solve()}{solve()}}
{\footnotesize\ttfamily \label{class_hybrid_a_d_r_solver_1_1_matrix_based_solver_a42698f5fb46f66c40aeccd03c277c05e} 
template$<$int dim$>$ \\
void \mbox{\hyperlink{class_hybrid_a_d_r_solver_1_1_matrix_based_solver}{Hybrid\+ADRSolver\+::\+Matrix\+Based\+Solver}}$<$ dim $>$\+::solve (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}, {\ttfamily [virtual]}}

Solve the linear system 

Implements \mbox{\hyperlink{class_hybrid_a_d_r_solver_1_1_parallel_solver_base_a98b341d0949ede6584d02d3520eb1642}{Hybrid\+ADRSolver\+::\+Parallel\+Solver\+Base$<$ dim $>$}}.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
src/include/matrix\+\_\+based/\mbox{\hyperlink{matrix__based__solver_8h}{matrix\+\_\+based\+\_\+solver.\+h}}\item 
src/include/matrix\+\_\+based/\mbox{\hyperlink{matrix__based__solver_8cpp}{matrix\+\_\+based\+\_\+solver.\+cpp}}\end{DoxyCompactItemize}
