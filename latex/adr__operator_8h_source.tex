\doxysection{adr\+\_\+operator.\+h}
\hypertarget{adr__operator_8h_source}{}\label{adr__operator_8h_source}\index{src/include/matrix\_free/adr\_operator.h@{src/include/matrix\_free/adr\_operator.h}}
\mbox{\hyperlink{adr__operator_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#ifndef\ HYBRIDADRSOLVER\_ADR\_OPERATOR\_H}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#define\ HYBRIDADRSOLVER\_ADR\_OPERATOR\_H}}
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{problem__definition_8h}{core/problem\_definition.h}}"{}}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{types_8h}{core/types.h}}"{}}}
\DoxyCodeLine{00006\ }
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ <deal.II/base/quadrature\_lib.h>}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ <deal.II/base/vectorization.h>}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ <deal.II/lac/la\_parallel\_vector.h>}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ <deal.II/matrix\_free/fe\_evaluation.h>}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ <deal.II/matrix\_free/matrix\_free.h>}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ <deal.II/matrix\_free/operators.h>}}
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00014\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceHybridADRSolver}{HybridADRSolver}}\ \{}
\DoxyCodeLine{00015\ \textcolor{keyword}{using\ namespace\ }dealii;}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00034\ \textcolor{keyword}{template}\ <\textcolor{keywordtype}{int}\ dim,\ \textcolor{keywordtype}{int}\ fe\_degree,\ \textcolor{keyword}{typename}\ Number\ =\ \textcolor{keywordtype}{double}>}
\DoxyCodeLine{00035\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classHybridADRSolver_1_1ADROperator_aed661703a9567f90494dbaf153590d67}{ADROperator}}\ :\ \textcolor{keyword}{public}\ Subscriptor\ \{}
\DoxyCodeLine{00036\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00037\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{classHybridADRSolver_1_1ADROperator_aff0ba29974dfe3ea1768c095eb3acb7e}{VectorType}}\ =\ LinearAlgebra::distributed::Vector<Number>;}
\DoxyCodeLine{00038\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{classHybridADRSolver_1_1ADROperator_a8ab55f16aef4f72e68b45bc8560b22cd}{value\_type}}\ =\ Number;}
\DoxyCodeLine{00039\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{classHybridADRSolver_1_1ADROperator_a9b20d4eeb7f2effb111ab3e73e798704}{size\_type}}\ =\ types::global\_dof\_index;}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00044\ \ \ \ \ \mbox{\hyperlink{classHybridADRSolver_1_1ADROperator_aed661703a9567f90494dbaf153590d67}{ADROperator}}()\ :\ problem\_ptr(nullptr)\ \{\}}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00053\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classHybridADRSolver_1_1ADROperator_aa468d145511e54150a5bf8c022caeff2}{initialize}}(std::shared\_ptr<\textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceHybridADRSolver_afe6d3d39f0c710383621e32a46108cb1af2674a258348188d6a3ee81d2669255a}{MatrixFree<dim,\ Number>}}>\ data\_in,}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classHybridADRSolver_1_1ProblemInterface}{ProblemInterface<dim>}}\&\ problem)\ \{}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ this-\/>data\ =\ data\_in;}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ this-\/>problem\_ptr\ =\ \&problem;}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ precompute\_coefficient\_data();}
\DoxyCodeLine{00058\ \ \ \ \ \}}
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00063\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classHybridADRSolver_1_1ADROperator_a8c5e5616fdaec818c0745f3deae93f34}{clear}}()\ \{}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ this-\/>data.reset();}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ problem\_ptr\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ diffusion\_coefficients.clear();}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ advection\_coefficients.clear();}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ reaction\_coefficients.clear();}
\DoxyCodeLine{00069\ \ \ \ \ \}}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00074\ \ \ \ \ \mbox{\hyperlink{classHybridADRSolver_1_1ADROperator_a9b20d4eeb7f2effb111ab3e73e798704}{size\_type}}\ \mbox{\hyperlink{classHybridADRSolver_1_1ADROperator_a0ae02b4f74e5493bea1ca521230bd8da}{m}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ Assert(this-\/>data.get()\ !=\ \textcolor{keyword}{nullptr},\ ExcNotInitialized());}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ this-\/>data-\/>get\_dof\_handler().n\_dofs();}
\DoxyCodeLine{00077\ \ \ \ \ \}}
\DoxyCodeLine{00078\ }
\DoxyCodeLine{00082\ \ \ \ \ \mbox{\hyperlink{classHybridADRSolver_1_1ADROperator_a9b20d4eeb7f2effb111ab3e73e798704}{size\_type}}\ \mbox{\hyperlink{classHybridADRSolver_1_1ADROperator_ae19d0ff622fc22e79b192bf9e4ade2da}{n}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classHybridADRSolver_1_1ADROperator_a0ae02b4f74e5493bea1ca521230bd8da}{m}}();\ \}}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00090\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classHybridADRSolver_1_1ADROperator_a101c5d878ba9926dc9e6e30947cb8aa2}{vmult}}(\mbox{\hyperlink{classHybridADRSolver_1_1ADROperator_aff0ba29974dfe3ea1768c095eb3acb7e}{VectorType}}\&\ dst,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classHybridADRSolver_1_1ADROperator_aff0ba29974dfe3ea1768c095eb3acb7e}{VectorType}}\&\ src)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ Assert(this-\/>data.get()\ !=\ \textcolor{keyword}{nullptr},\ ExcNotInitialized());}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ dst\ =\ 0;}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classHybridADRSolver_1_1ADROperator_a475a8215de7eb19ef2dbd3a4f4396762}{vmult\_add}}(dst,\ src);}
\DoxyCodeLine{00094\ \ \ \ \ \}}
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00102\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classHybridADRSolver_1_1ADROperator_a475a8215de7eb19ef2dbd3a4f4396762}{vmult\_add}}(\mbox{\hyperlink{classHybridADRSolver_1_1ADROperator_aff0ba29974dfe3ea1768c095eb3acb7e}{VectorType}}\&\ dst,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classHybridADRSolver_1_1ADROperator_aff0ba29974dfe3ea1768c095eb3acb7e}{VectorType}}\&\ src)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ Assert(this-\/>data.get()\ !=\ \textcolor{keyword}{nullptr},\ ExcNotInitialized());}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ this-\/>data-\/>cell\_loop(\&ADROperator::local\_apply,\ \textcolor{keyword}{this},\ dst,\ src);}
\DoxyCodeLine{00105\ \ \ \ \ \}}
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00113\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classHybridADRSolver_1_1ADROperator_aa4a1e6777fef75161fcf6f4c1501b0fa}{Tvmult}}(\mbox{\hyperlink{classHybridADRSolver_1_1ADROperator_aff0ba29974dfe3ea1768c095eb3acb7e}{VectorType}}\&\ dst,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classHybridADRSolver_1_1ADROperator_aff0ba29974dfe3ea1768c095eb3acb7e}{VectorType}}\&\ src)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ Assert(this-\/>data.get()\ !=\ \textcolor{keyword}{nullptr},\ ExcNotInitialized());}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ dst\ =\ 0;}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classHybridADRSolver_1_1ADROperator_a0fef8e8e00fbc3e17c11726b3d67422f}{Tvmult\_add}}(dst,\ src);}
\DoxyCodeLine{00117\ \ \ \ \ \}}
\DoxyCodeLine{00118\ }
\DoxyCodeLine{00122\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classHybridADRSolver_1_1ADROperator_a0fef8e8e00fbc3e17c11726b3d67422f}{Tvmult\_add}}(\mbox{\hyperlink{classHybridADRSolver_1_1ADROperator_aff0ba29974dfe3ea1768c095eb3acb7e}{VectorType}}\&\ dst,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classHybridADRSolver_1_1ADROperator_aff0ba29974dfe3ea1768c095eb3acb7e}{VectorType}}\&\ src)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ Assert(this-\/>data.get()\ !=\ \textcolor{keyword}{nullptr},\ ExcNotInitialized());}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ For\ the\ transpose,\ we\ negate\ the\ advection\ term}}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ this-\/>data-\/>cell\_loop(\&ADROperator::local\_apply\_transpose,\ \textcolor{keyword}{this},\ dst,}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ src);}
\DoxyCodeLine{00127\ \ \ \ \ \}}
\DoxyCodeLine{00128\ }
\DoxyCodeLine{00134\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classHybridADRSolver_1_1ADROperator_a6c57796c2fb3c8bf1fa6a1e09a507dbc}{compute\_diagonal}}(\mbox{\hyperlink{classHybridADRSolver_1_1ADROperator_aff0ba29974dfe3ea1768c095eb3acb7e}{VectorType}}\&\ diagonal)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ Assert(this-\/>data.get()\ !=\ \textcolor{keyword}{nullptr},\ ExcNotInitialized());}
\DoxyCodeLine{00136\ }
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ diagonal.reinit(this-\/>data-\/>get\_dof\_handler().locally\_owned\_dofs(),}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>data-\/>get\_task\_info().communicator);}
\DoxyCodeLine{00139\ }
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Use\ FEEvaluation\ to\ compute\ diagonal\ entries}}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ this-\/>data-\/>initialize\_dof\_vector(diagonal);}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ diagonal\ =\ 0;}
\DoxyCodeLine{00143\ }
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Apply\ to\ unit\ vectors\ to\ extract\ diagonal}}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classHybridADRSolver_1_1ADROperator_aff0ba29974dfe3ea1768c095eb3acb7e}{VectorType}}\ ones;}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ this-\/>data-\/>initialize\_dof\_vector(ones);}
\DoxyCodeLine{00147\ }
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Compute\ diagonal\ using\ cell\ loop\ with\ special\ diagonal\ computation}}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ this-\/>data-\/>cell\_loop(\&ADROperator::local\_compute\_diagonal,\ \textcolor{keyword}{this},}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ diagonal,\ ones);}
\DoxyCodeLine{00151\ }
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ diagonal.compress(VectorOperation::add);}
\DoxyCodeLine{00153\ \ \ \ \ \}}
\DoxyCodeLine{00154\ }
\DoxyCodeLine{00160\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classHybridADRSolver_1_1ADROperator_ae7493904390d63cc394f4ff1458ad9db}{compute\_inverse\_diagonal}}(\mbox{\hyperlink{classHybridADRSolver_1_1ADROperator_aff0ba29974dfe3ea1768c095eb3acb7e}{VectorType}}\&\ inverse\_diagonal)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classHybridADRSolver_1_1ADROperator_a6c57796c2fb3c8bf1fa6a1e09a507dbc}{compute\_diagonal}}(inverse\_diagonal);}
\DoxyCodeLine{00162\ }
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Invert\ diagonal\ entries,\ handling\ near-\/zero\ values}}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ val\ :\ inverse\_diagonal)}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ \ \ \ \ val\ =\ (std::abs(val)\ >\ 1e-\/14)\ ?\ 1.0\ /\ val\ :\ 1.0;}
\DoxyCodeLine{00166\ \ \ \ \ \}}
\DoxyCodeLine{00167\ }
\DoxyCodeLine{00171\ \ \ \ \ std::shared\_ptr<const\ MatrixFree<dim,\ Number>>\ \mbox{\hyperlink{classHybridADRSolver_1_1ADROperator_a76974e20b4f4bab4d450871c650dfbc4}{get\_matrix\_free}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ this-\/>data;}
\DoxyCodeLine{00173\ \ \ \ \ \}}
\DoxyCodeLine{00174\ }
\DoxyCodeLine{00178\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classHybridADRSolver_1_1ADROperator_a6856d8ccbe8b4616afa229c22fb66f10}{initialize\_dof\_vector}}(\mbox{\hyperlink{classHybridADRSolver_1_1ADROperator_aff0ba29974dfe3ea1768c095eb3acb7e}{VectorType}}\&\ vec)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ this-\/>data-\/>initialize\_dof\_vector(vec);}
\DoxyCodeLine{00180\ \ \ \ \ \}}
\DoxyCodeLine{00181\ }
\DoxyCodeLine{00182\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00190\ \ \ \ \ \textcolor{keywordtype}{void}\ precompute\_coefficient\_data()\ \{}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ Assert(problem\_ptr\ !=\ \textcolor{keyword}{nullptr},\ ExcNotInitialized());}
\DoxyCodeLine{00192\ }
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ n\_cells\ =\ this-\/>data-\/>n\_cell\_batches();}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ n\_q\_points\ =\ Utilities::pow(fe\_degree\ +\ 1,\ dim);}
\DoxyCodeLine{00195\ }
\DoxyCodeLine{00196\ \ \ \ \ \ \ \ \ diffusion\_coefficients.resize(n\_cells);}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \ \ advection\_coefficients.resize(n\_cells);}
\DoxyCodeLine{00198\ \ \ \ \ \ \ \ \ reaction\_coefficients.resize(n\_cells);}
\DoxyCodeLine{00199\ }
\DoxyCodeLine{00200\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Use\ FEEvaluation\ to\ get\ quadrature\ points}}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \ \ FEEvaluation<dim,\ fe\_degree,\ fe\_degree\ +\ 1,\ 1,\ Number>\ phi(*this-\/>data);}
\DoxyCodeLine{00202\ }
\DoxyCodeLine{00203\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ cell\ =\ 0;\ cell\ <\ n\_cells;\ ++cell)\ \{}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ \ \ \ \ phi.reinit(cell);}
\DoxyCodeLine{00205\ }
\DoxyCodeLine{00206\ \ \ \ \ \ \ \ \ \ \ \ \ diffusion\_coefficients[cell].resize(n\_q\_points);}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \ \ \ \ \ \ advection\_coefficients[cell].resize(n\_q\_points);}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \ \ \ \ \ \ reaction\_coefficients[cell].resize(n\_q\_points);}
\DoxyCodeLine{00209\ }
\DoxyCodeLine{00210\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ q\ =\ 0;\ q\ <\ n\_q\_points;\ ++q)\ \{}
\DoxyCodeLine{00211\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ the\ vectorized\ quadrature\ point}}
\DoxyCodeLine{00212\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Point<dim,\ VectorizedArray<Number>>\ q\_point\ =}
\DoxyCodeLine{00213\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ phi.quadrature\_point(q);}
\DoxyCodeLine{00214\ }
\DoxyCodeLine{00215\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Evaluate\ coefficients\ for\ each\ lane\ in\ the\ vector}}
\DoxyCodeLine{00216\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ VectorizedArray<Number>\ mu;}
\DoxyCodeLine{00217\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Tensor<1,\ dim,\ VectorizedArray<Number>>\ beta;}
\DoxyCodeLine{00218\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ VectorizedArray<Number>\ gamma;}
\DoxyCodeLine{00219\ }
\DoxyCodeLine{00220\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ v\ =\ 0;\ v\ <\ VectorizedArray<Number>::size();}
\DoxyCodeLine{00221\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ++v)\ \{}
\DoxyCodeLine{00222\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Point<dim>\ p;}
\DoxyCodeLine{00223\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ d\ =\ 0;\ d\ <\ dim;\ ++d)}
\DoxyCodeLine{00224\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ p[d]\ =\ q\_point[d][v];}
\DoxyCodeLine{00225\ }
\DoxyCodeLine{00226\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mu[v]\ =\ problem\_ptr-\/>diffusion\_coefficient(p);}
\DoxyCodeLine{00227\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ gamma[v]\ =\ problem\_ptr-\/>reaction\_coefficient(p);}
\DoxyCodeLine{00228\ }
\DoxyCodeLine{00229\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Tensor<1,\ dim>\ beta\_scalar\ =}
\DoxyCodeLine{00230\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ problem\_ptr-\/>advection\_field(p);}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ d\ =\ 0;\ d\ <\ dim;\ ++d)}
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ beta[d][v]\ =\ beta\_scalar[d];}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00234\ }
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ diffusion\_coefficients[cell][q]\ =\ mu;}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ advection\_coefficients[cell][q]\ =\ beta;}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reaction\_coefficients[cell][q]\ =\ gamma;}
\DoxyCodeLine{00238\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00240\ \ \ \ \ \}}
\DoxyCodeLine{00241\ }
\DoxyCodeLine{00248\ \ \ \ \ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00249\ \ \ \ \ local\_apply(\textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceHybridADRSolver_afe6d3d39f0c710383621e32a46108cb1af2674a258348188d6a3ee81d2669255a}{MatrixFree<dim,\ Number>}}\&\ mf\_data,\ \mbox{\hyperlink{classHybridADRSolver_1_1ADROperator_aff0ba29974dfe3ea1768c095eb3acb7e}{VectorType}}\&\ dst,}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classHybridADRSolver_1_1ADROperator_aff0ba29974dfe3ea1768c095eb3acb7e}{VectorType}}\&\ src,}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::pair<unsigned\ int,\ unsigned\ int>\&\ cell\_range)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \ \ FEEvaluation<dim,\ fe\_degree,\ fe\_degree\ +\ 1,\ 1,\ Number>\ phi(mf\_data);}
\DoxyCodeLine{00253\ }
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ cell\ =\ cell\_range.first;\ cell\ <\ cell\_range.second;}
\DoxyCodeLine{00255\ \ \ \ \ \ \ \ \ \ \ \ \ \ ++cell)\ \{}
\DoxyCodeLine{00256\ \ \ \ \ \ \ \ \ \ \ \ \ phi.reinit(cell);}
\DoxyCodeLine{00257\ \ \ \ \ \ \ \ \ \ \ \ \ phi.gather\_evaluate(src,\ EvaluationFlags::values\ |}
\DoxyCodeLine{00258\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ EvaluationFlags::gradients);}
\DoxyCodeLine{00259\ }
\DoxyCodeLine{00260\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ q\ =\ 0;\ q\ <\ phi.n\_q\_points;\ ++q)\ \{}
\DoxyCodeLine{00261\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ VectorizedArray<Number>\ u\_val\ =\ phi.get\_value(q);}
\DoxyCodeLine{00262\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Tensor<1,\ dim,\ VectorizedArray<Number>>\ grad\_u\ =}
\DoxyCodeLine{00263\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ phi.get\_gradient(q);}
\DoxyCodeLine{00264\ }
\DoxyCodeLine{00265\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Diffusion:\ mu\ *\ grad(u)}}
\DoxyCodeLine{00266\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Tensor<1,\ dim,\ VectorizedArray<Number>>\ flux\ =}
\DoxyCodeLine{00267\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ diffusion\_coefficients[cell][q]\ *\ grad\_u;}
\DoxyCodeLine{00268\ }
\DoxyCodeLine{00269\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Advection\ contribution\ to\ flux:\ (beta\ ·\ grad(u))\ *\ v}}
\DoxyCodeLine{00270\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ This\ is\ handled\ via\ the\ value\ term\ below}}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ VectorizedArray<Number>\ advection\_val\ =}
\DoxyCodeLine{00272\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ advection\_coefficients[cell][q]\ *\ grad\_u;}
\DoxyCodeLine{00273\ }
\DoxyCodeLine{00274\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Reaction:\ gamma\ *\ u}}
\DoxyCodeLine{00275\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ VectorizedArray<Number>\ val\ =}
\DoxyCodeLine{00276\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reaction\_coefficients[cell][q]\ *\ u\_val\ +\ advection\_val;}
\DoxyCodeLine{00277\ }
\DoxyCodeLine{00278\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ phi.submit\_gradient(flux,\ q);}
\DoxyCodeLine{00279\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ phi.submit\_value(val,\ q);}
\DoxyCodeLine{00280\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00281\ }
\DoxyCodeLine{00282\ \ \ \ \ \ \ \ \ \ \ \ \ phi.integrate\_scatter(}
\DoxyCodeLine{00283\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ EvaluationFlags::values\ |\ EvaluationFlags::gradients,\ dst);}
\DoxyCodeLine{00284\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00285\ \ \ \ \ \}}
\DoxyCodeLine{00286\ }
\DoxyCodeLine{00292\ \ \ \ \ \textcolor{keywordtype}{void}\ local\_apply\_transpose(}
\DoxyCodeLine{00293\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceHybridADRSolver_afe6d3d39f0c710383621e32a46108cb1af2674a258348188d6a3ee81d2669255a}{MatrixFree<dim,\ Number>}}\&\ mf\_data,\ \mbox{\hyperlink{classHybridADRSolver_1_1ADROperator_aff0ba29974dfe3ea1768c095eb3acb7e}{VectorType}}\&\ dst,}
\DoxyCodeLine{00294\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classHybridADRSolver_1_1ADROperator_aff0ba29974dfe3ea1768c095eb3acb7e}{VectorType}}\&\ src,}
\DoxyCodeLine{00295\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::pair<unsigned\ int,\ unsigned\ int>\&\ cell\_range)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00296\ \ \ \ \ \ \ \ \ FEEvaluation<dim,\ fe\_degree,\ fe\_degree\ +\ 1,\ 1,\ Number>\ phi(mf\_data);}
\DoxyCodeLine{00297\ }
\DoxyCodeLine{00298\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ cell\ =\ cell\_range.first;\ cell\ <\ cell\_range.second;}
\DoxyCodeLine{00299\ \ \ \ \ \ \ \ \ \ \ \ \ \ ++cell)\ \{}
\DoxyCodeLine{00300\ \ \ \ \ \ \ \ \ \ \ \ \ phi.reinit(cell);}
\DoxyCodeLine{00301\ \ \ \ \ \ \ \ \ \ \ \ \ phi.gather\_evaluate(src,\ EvaluationFlags::values\ |}
\DoxyCodeLine{00302\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ EvaluationFlags::gradients);}
\DoxyCodeLine{00303\ }
\DoxyCodeLine{00304\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ q\ =\ 0;\ q\ <\ phi.n\_q\_points;\ ++q)\ \{}
\DoxyCodeLine{00305\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ VectorizedArray<Number>\ u\_val\ =\ phi.get\_value(q);}
\DoxyCodeLine{00306\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Tensor<1,\ dim,\ VectorizedArray<Number>>\ grad\_u\ =}
\DoxyCodeLine{00307\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ phi.get\_gradient(q);}
\DoxyCodeLine{00308\ }
\DoxyCodeLine{00309\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Diffusion\ (symmetric)}}
\DoxyCodeLine{00310\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Tensor<1,\ dim,\ VectorizedArray<Number>>\ flux\ =}
\DoxyCodeLine{00311\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ diffusion\_coefficients[cell][q]\ *\ grad\_u;}
\DoxyCodeLine{00312\ }
\DoxyCodeLine{00313\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Transpose\ of\ advection:\ -\/(beta\ ·\ grad(v))\ *\ u}}
\DoxyCodeLine{00314\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ In\ weak\ form,\ this\ becomes\ +(div(beta)\ *\ u,\ v)\ -\/\ (beta\ *\ u,}}
\DoxyCodeLine{00315\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ grad(v))\ For\ divergence-\/free\ beta,\ this\ simplifies}}
\DoxyCodeLine{00316\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ VectorizedArray<Number>\ advection\_val\ =}
\DoxyCodeLine{00317\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/advection\_coefficients[cell][q]\ *\ grad\_u;}
\DoxyCodeLine{00318\ }
\DoxyCodeLine{00319\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Reaction\ (symmetric)}}
\DoxyCodeLine{00320\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ VectorizedArray<Number>\ val\ =}
\DoxyCodeLine{00321\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reaction\_coefficients[cell][q]\ *\ u\_val\ +\ advection\_val;}
\DoxyCodeLine{00322\ }
\DoxyCodeLine{00323\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ phi.submit\_gradient(flux,\ q);}
\DoxyCodeLine{00324\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ phi.submit\_value(val,\ q);}
\DoxyCodeLine{00325\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00326\ }
\DoxyCodeLine{00327\ \ \ \ \ \ \ \ \ \ \ \ \ phi.integrate\_scatter(}
\DoxyCodeLine{00328\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ EvaluationFlags::values\ |\ EvaluationFlags::gradients,\ dst);}
\DoxyCodeLine{00329\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00330\ \ \ \ \ \}}
\DoxyCodeLine{00331\ }
\DoxyCodeLine{00335\ \ \ \ \ \textcolor{keywordtype}{void}\ local\_compute\_diagonal(}
\DoxyCodeLine{00336\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceHybridADRSolver_afe6d3d39f0c710383621e32a46108cb1af2674a258348188d6a3ee81d2669255a}{MatrixFree<dim,\ Number>}}\&\ mf\_data,\ \mbox{\hyperlink{classHybridADRSolver_1_1ADROperator_aff0ba29974dfe3ea1768c095eb3acb7e}{VectorType}}\&\ dst,}
\DoxyCodeLine{00337\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classHybridADRSolver_1_1ADROperator_aff0ba29974dfe3ea1768c095eb3acb7e}{VectorType}}\&\ \textcolor{comment}{/*src*/},}
\DoxyCodeLine{00338\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::pair<unsigned\ int,\ unsigned\ int>\&\ cell\_range)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00339\ \ \ \ \ \ \ \ \ FEEvaluation<dim,\ fe\_degree,\ fe\_degree\ +\ 1,\ 1,\ Number>\ phi(mf\_data);}
\DoxyCodeLine{00340\ }
\DoxyCodeLine{00341\ \ \ \ \ \ \ \ \ AlignedVector<VectorizedArray<Number>>\ diagonal\_values(}
\DoxyCodeLine{00342\ \ \ \ \ \ \ \ \ \ \ \ \ phi.dofs\_per\_cell);}
\DoxyCodeLine{00343\ }
\DoxyCodeLine{00344\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ cell\ =\ cell\_range.first;\ cell\ <\ cell\_range.second;}
\DoxyCodeLine{00345\ \ \ \ \ \ \ \ \ \ \ \ \ \ ++cell)\ \{}
\DoxyCodeLine{00346\ \ \ \ \ \ \ \ \ \ \ \ \ phi.reinit(cell);}
\DoxyCodeLine{00347\ }
\DoxyCodeLine{00348\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ phi.dofs\_per\_cell;\ ++i)\ \{}
\DoxyCodeLine{00349\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Set\ unit\ vector}}
\DoxyCodeLine{00350\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ phi.dofs\_per\_cell;\ ++j)}
\DoxyCodeLine{00351\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ phi.submit\_dof\_value(VectorizedArray<Number>(),\ j);}
\DoxyCodeLine{00352\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ phi.submit\_dof\_value(make\_vectorized\_array<Number>(1.0),\ i);}
\DoxyCodeLine{00353\ }
\DoxyCodeLine{00354\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ phi.evaluate(EvaluationFlags::values\ |}
\DoxyCodeLine{00355\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ EvaluationFlags::gradients);}
\DoxyCodeLine{00356\ }
\DoxyCodeLine{00357\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ q\ =\ 0;\ q\ <\ phi.n\_q\_points;\ ++q)\ \{}
\DoxyCodeLine{00358\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ VectorizedArray<Number>\ u\_val\ =\ phi.get\_value(q);}
\DoxyCodeLine{00359\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Tensor<1,\ dim,\ VectorizedArray<Number>>\ grad\_u\ =}
\DoxyCodeLine{00360\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ phi.get\_gradient(q);}
\DoxyCodeLine{00361\ }
\DoxyCodeLine{00362\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Tensor<1,\ dim,\ VectorizedArray<Number>>\ flux\ =}
\DoxyCodeLine{00363\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ diffusion\_coefficients[cell][q]\ *\ grad\_u;}
\DoxyCodeLine{00364\ }
\DoxyCodeLine{00365\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ VectorizedArray<Number>\ advection\_val\ =}
\DoxyCodeLine{00366\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ advection\_coefficients[cell][q]\ *\ grad\_u;}
\DoxyCodeLine{00367\ }
\DoxyCodeLine{00368\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ VectorizedArray<Number>\ val\ =}
\DoxyCodeLine{00369\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reaction\_coefficients[cell][q]\ *\ u\_val\ +\ advection\_val;}
\DoxyCodeLine{00370\ }
\DoxyCodeLine{00371\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ phi.submit\_gradient(flux,\ q);}
\DoxyCodeLine{00372\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ phi.submit\_value(val,\ q);}
\DoxyCodeLine{00373\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00374\ }
\DoxyCodeLine{00375\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ phi.integrate(EvaluationFlags::values\ |}
\DoxyCodeLine{00376\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ EvaluationFlags::gradients);}
\DoxyCodeLine{00377\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ diagonal\_values[i]\ =\ phi.get\_dof\_value(i);}
\DoxyCodeLine{00378\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00379\ }
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ phi.dofs\_per\_cell;\ ++i)}
\DoxyCodeLine{00381\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ phi.submit\_dof\_value(diagonal\_values[i],\ i);}
\DoxyCodeLine{00382\ \ \ \ \ \ \ \ \ \ \ \ \ phi.distribute\_local\_to\_global(dst);}
\DoxyCodeLine{00383\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00384\ \ \ \ \ \}}
\DoxyCodeLine{00385\ }
\DoxyCodeLine{00386\ \ \ \ \ \textcolor{comment}{//\ Data\ members}}
\DoxyCodeLine{00387\ \ \ \ \ std::shared\_ptr<const\ MatrixFree<dim,\ Number>>\ data;}
\DoxyCodeLine{00388\ \ \ \ \ \textcolor{keyword}{const}\ ProblemInterface<dim>*\ problem\_ptr;}
\DoxyCodeLine{00389\ }
\DoxyCodeLine{00390\ \ \ \ \ \textcolor{comment}{//\ Precomputed\ coefficients\ at\ quadrature\ points}}
\DoxyCodeLine{00391\ \ \ \ \ std::vector<std::vector<VectorizedArray<Number>>>\ diffusion\_coefficients;}
\DoxyCodeLine{00392\ \ \ \ \ std::vector<std::vector<Tensor<1,\ dim,\ VectorizedArray<Number>>>>}
\DoxyCodeLine{00393\ \ \ \ \ \ \ \ \ advection\_coefficients;}
\DoxyCodeLine{00394\ \ \ \ \ std::vector<std::vector<VectorizedArray<Number>>>\ reaction\_coefficients;}
\DoxyCodeLine{00395\ \};}
\DoxyCodeLine{00396\ }
\DoxyCodeLine{00402\ \textcolor{keyword}{template}\ <\textcolor{keywordtype}{int}\ dim,\ \textcolor{keywordtype}{int}\ fe\_degree,\ \textcolor{keyword}{typename}\ Number\ =\ \textcolor{keywordtype}{double}>}
\DoxyCodeLine{00403\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classHybridADRSolver_1_1JacobiPreconditioner}{JacobiPreconditioner}}\ \{}
\DoxyCodeLine{00404\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00405\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{classHybridADRSolver_1_1JacobiPreconditioner_a379c15643b52436d227f5c7efed6dc53}{VectorType}}\ =\ LinearAlgebra::distributed::Vector<Number>;}
\DoxyCodeLine{00406\ }
\DoxyCodeLine{00410\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classHybridADRSolver_1_1JacobiPreconditioner_aca6fead7d20eb49cae04755ff052af55}{initialize}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classHybridADRSolver_1_1ADROperator}{ADROperator<dim,\ fe\_degree,\ Number>}}\&\ op)\ \{}
\DoxyCodeLine{00411\ \ \ \ \ \ \ \ \ op.\mbox{\hyperlink{classHybridADRSolver_1_1ADROperator_ae7493904390d63cc394f4ff1458ad9db}{compute\_inverse\_diagonal}}(inverse\_diagonal);}
\DoxyCodeLine{00412\ \ \ \ \ \}}
\DoxyCodeLine{00413\ }
\DoxyCodeLine{00417\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classHybridADRSolver_1_1JacobiPreconditioner_ad5b1a748a6bf6df9d00878742f8dae67}{vmult}}(\mbox{\hyperlink{classHybridADRSolver_1_1JacobiPreconditioner_a379c15643b52436d227f5c7efed6dc53}{VectorType}}\&\ dst,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classHybridADRSolver_1_1JacobiPreconditioner_a379c15643b52436d227f5c7efed6dc53}{VectorType}}\&\ src)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00418\ \ \ \ \ \ \ \ \ dst\ =\ src;}
\DoxyCodeLine{00419\ \ \ \ \ \ \ \ \ dst.scale(inverse\_diagonal);}
\DoxyCodeLine{00420\ \ \ \ \ \}}
\DoxyCodeLine{00421\ }
\DoxyCodeLine{00422\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00423\ \ \ \ \ \mbox{\hyperlink{classHybridADRSolver_1_1JacobiPreconditioner_a379c15643b52436d227f5c7efed6dc53}{VectorType}}\ inverse\_diagonal;}
\DoxyCodeLine{00424\ \};}
\DoxyCodeLine{00425\ \}\ \textcolor{comment}{//\ namespace\ HybridADRSolver}}
\DoxyCodeLine{00426\ }
\DoxyCodeLine{00427\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ HYBRIDADRSOLVER\_ADR\_OPERATOR\_H}}

\end{DoxyCode}
